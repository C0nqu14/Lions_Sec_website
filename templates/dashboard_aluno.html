{% extends "base.html" %}
{% block title %}Dashboard Aluno{% endblock %}
{% block content %}

<div class="py-5">
    
    <h1 class="page-title mb-4">
        <span class="highlight-red">//</span> CONSOLE DE TREINAMENTO
    </h1>
    <p class="lead text-muted mb-5">
        Bem-vindo(a), <span class="highlight-red">{{ current_user.username | upper }}</span>. Aqui você acompanha seu progresso em cursos e desafios CTF.
    </p>

    <h2 class="page-title fs-3 mb-4">
        <span class="highlight-red">>></span> RESUMO DO PROGRESSO
    </h2>
    
    <div class="row g-4 mb-5">
        
        <div class="col-lg-4 col-md-6">
            <a href="{{ url_for('my_courses') }}" class="card-link" style="text-decoration: none;">
                <div class="card p-4 h-100 card-hover-red">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-graduation-cap fa-3x highlight-red me-4"></i>
                        <div>
                            <p class="text-muted mb-0 small">CURSOS AUTORIZADOS</p>
                            <h3 class="card-title display-6 fw-bold">{{ authorized_courses_count }}</h3>
                        </div>
                    </div>
                </div>
            </a>
        </div>

        <div class="col-lg-4 col-md-6">
            <a href="{{ url_for('ctf_ranking') }}" class="card-link" style="text-decoration: none;">
                <div class="card p-4 h-100 card-hover-red">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-flag-checkered fa-3x highlight-red me-4"></i>
                        <div>
                            <p class="text-muted mb-0 small">SCORE CTF TOTAL</p>
                            <h3 class="card-title display-6 fw-bold">{{ total_ctf_score }}</h3>
                        </div>
                    </div>
                </div>
            </a>
        </div>

        <div class="col-lg-4 col-md-12">
            <a href="{{ url_for('ctfs') }}" class="card-link" style="text-decoration: none;">
                <div class="card p-4 h-100 card-hover-red">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-puzzle-piece fa-3x highlight-red me-4"></i>
                        <div>
                            <p class="text-muted mb-0 small">CTFS SOLUCIONADOS</p>
                            <h3 class="card-title display-6 fw-bold">{{ solved_ctfs_count }}</h3>
                        </div>
                    </div>
                </div>
            </a>
        </div>
    </div>
    
    <h2 class="page-title fs-3 mb-4">
        <span class="highlight-red">>></span> CONTINUAR TREINAMENTO
    </h2>
    
    <div class="row g-4 mb-5">
        {% if in_progress_courses %}
            {% for enrollment in in_progress_courses[:3] %}
                <div class="col-lg-4 col-md-6">
                    <div class="card p-4 h-100">
                        <h5 class="card-title fw-bold text-truncate">{{ enrollment.course.title }}</h5>
                        <p class="text-muted small mb-3">
                            <i class="fas fa-chalkboard-teacher me-1"></i> Professor: {{ enrollment.course.professor.username }}
                        </p>
                        <p class="text-xs text-secondary mb-3">
                            Acompanhe o conteúdo deste curso.
                        </p>
                        
                        <a href="{{ url_for('watch_course', course_id=enrollment.course.id) }}" class="btn btn-outline-red btn-sm mt-auto">
                            Continuar <i class="fas fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            {% endfor %}
            
            {% if in_progress_courses|length > 3 %}
                <div class="col-lg-4 col-md-6">
                    <div class="card p-4 h-100 d-flex align-items-center justify-content-center text-center bg-dark-alt">
                        <h5 class="fw-bold">Ver Todos</h5>
                        <p class="text-muted small">Você tem mais cursos ativos.</p>
                        <a href="{{ url_for('my_courses') }}" class="btn btn-red btn-sm">
                            Ir para Meus Cursos
                        </a>
                    </div>
                </div>
            {% endif %}
            
        {% else %}
            <div class="col-12">
                <div class="alert alert-info text-center" role="alert">
                    <p class="mb-0"><i class="fas fa-search me-2"></i>Comece explorando os <a href="{{ url_for('courses') }}" class="alert-link highlight-red fw-bold">cursos disponíveis</a>.</p>
                </div>
            </div>
        {% endif %}
    </div>

    <hr style="border-color: var(--color-border);" class="my-5">
    <h2 class="page-title fs-3 mb-4">
        <span class="highlight-red">>></span> ACESSO RÁPIDO
    </h2>

    <div class="row g-4">
        <div class="col-lg-4 col-md-6">
            <a href="{{ url_for('ctfs') }}" class="card-link" style="text-decoration: none;">
                <div class="card p-4 h-100 bg-dark-alt">
                    <i class="fas fa-terminal fa-2x highlight-red mb-3"></i>
                    <h5 class="card-title fw-bold">Desafios CTF</h5>
                    <p class="text-muted small mb-0">Participe dos desafios e suba no ranking!</p>
                </div>
            </a>
        </div>
        <div class="col-lg-4 col-md-6">
            <a href="{{ url_for('courses') }}" class="card-link" style="text-decoration: none;">
                <div class="card p-4 h-100 bg-dark-alt">
                    <i class="fas fa-globe fa-2x highlight-red mb-3"></i>
                    <h5 class="card-title fw-bold">Catálogo de Cursos</h5>
                    <p class="text-muted small mb-0">Encontre novos treinamentos e solicite sua inscrição.</p>
                </div>
            </a>
        </div>
        <div class="col-lg-4 col-md-6">
            <a href="{{ url_for('ctf_ranking') }}" class="card-link" style="text-decoration: none;">
                <div class="card p-4 h-100 bg-dark-alt">
                    <i class="fas fa-trophy fa-2x highlight-red mb-3"></i>
                    <h5 class="card-title fw-bold">Ranking Global</h5>
                    <p class="text-muted small mb-0">Veja sua posição entre os melhores hackers da plataforma.</p>
                </div>
            </a>
        </div>
    </div>
</div>

{% endblock %}