{% extends "base.html" %}
{% block title %}Cursos{% endblock %}
{% block content %}
<h1 class="page-title">Nossos Cursos</h1>
<div style="display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:16px;">
  {% for course in courses %}
  <div class="card" style="text-decoration:none;">
    <h2 style="font-weight:800; margin-bottom:6px;">{{ course.title }}</h2>
    <p class="muted" style="margin-bottom:10px; min-height:60px; overflow:hidden;">{{ course.description }}</p>

    {% set status = user_enrollments.get(course.id, 'NONE') %}

    {% if current_user.is_authenticated %}
      {% if status == 'PROFESSOR' %}
        <a href="{{ url_for('manage_course', course_id=course.id) }}" class="btn btn-info" style="width:100%;">Gerenciar Curso</a>
      {% elif status == 'AUTORIZADO' %}
        <a href="{{ url_for('watch_course', course_id=course.id) }}" class="btn btn-primary" style="width:100%;">Assistir Curso</a>
      {% elif status == 'PENDENTE' %}
         <button class="btn btn-ghost" disabled style="width:100%; color:#d97706; border-color:#d97706;">Inscrição Pendente</button>
      {% elif status == 'REJEITADO' %}
         <button class="btn btn-ghost" disabled style="width:100%; color:#ef4444; border-color:#ef4444;">Inscrição Rejeitada</button>
      {% else %}
        <a href="{{ url_for('enroll_course', course_id=course.id) }}" class="btn btn-primary" style="width:100%;">Inscrever-se</a>
      {% endif %}
    {% else %}
      <a href="{{ url_for('login') }}" class="btn btn-primary" style="width:100%;">Faça Login</a>
    {% endif %}

  </div>
  {% else %}
    <p class="muted">Nenhum curso disponível.</p>
  {% endfor %}
</div>
{% endblock %}